"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createController = void 0;
const RemoteComponent_1 = require("./RemoteComponent");
const RemoteText_1 = require("./RemoteText");
function createController(components, { renderComponent: externalRenderComponent, renderText: externalRenderText, } = {}) {
    const registry = new Map(Object.entries(components));
    const renderComponent = externalRenderComponent
        ? (componentProps) => externalRenderComponent(componentProps, {
            renderDefault() {
                return RemoteComponent_1.renderComponent(componentProps);
            },
        })
        : RemoteComponent_1.renderComponent;
    const renderText = externalRenderText
        ? (textProps) => externalRenderText(textProps, {
            renderDefault() {
                return RemoteText_1.renderText(textProps);
            },
        })
        : RemoteText_1.renderText;
    return {
        get(type) {
            const value = registry.get(type);
            if (value == null) {
                throw new Error(`Unknown component: ${type}`);
            }
            return value;
        },
        renderer: {
            renderComponent,
            renderText,
        },
    };
}
exports.createController = createController;
