import { retain, release } from '@remote-ui/rpc';

function createRemoteSubscribable(subscription) {
  var initial = subscription.current;
  return {
    initial: initial,
    subscribe: function subscribe(subscriber) {
      retain(subscriber);
      var unsubscribe = subscription.subscribe(function () {
        var value = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : subscription.current;
        subscriber(value);
      });

      var teardown = function teardown() {
        unsubscribe();
        release(subscriber);
      };

      return [teardown, subscription.current];
    }
  };
}

export { createRemoteSubscribable };
